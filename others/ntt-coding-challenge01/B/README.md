# B問題: 2048の復讐

実行制限時間: 5 sec / メモリ制限: 512 MB / 配点: 200点

## 問題文

「2048」というゲームのサブセット、「2048dash」を実装していただきます。ゲームのルールを説明します。

N行 * M列 に1以上の数字の書かれたタイルの並べられた盤面が与えられます。
例として、2行 * 3列の盤面を見てみます。

```
2 4 2
2 4 8
```

この盤面には4つの「操作」を加えることが可能です。
その4つの操作とは「上への移動、下への移動、右への移動、左への移動」です。
それぞれを略して「U, D, R, L」と名付けることにします。

移動を行うと、数字の書かれたタイルを上、下、右、左へ詰める動きをします。
最初、盤面は数字で埋まっているため各数字は動きませんが、ある条件で二つの数字は「合成」します。
その条件はスライドする方向に同じ数字が並んでいるとき、その数字は合成されて倍の数字となります。
例えば上の例の盤面で U を実行すると以下のような盤面になります。

```
4 8 2
0 0 8
```

0は空きの部分を示します。さらにこの盤面から D を実行すると、空きの部分を詰めるようにタイルが移動するため、以下のような盤面になります。

```
0 0 2
4 8 8
```

同じ数字が3つ以上連続並んでいた場合は、移動が起こる方向から2つずつの合成が同時に発生します。
例えば、1行 * 6列 の以下のような盤面を考えます。

```
2 2 2 2 4 8
```

ここにLを実行すると、結果は以下のようになります。

```
4 4 4 8 0 0
```

これは、元の盤面で言うと `(2 2) (2 2) 4 8` という合成が起こっています。
進行方向上の合成は、移動と同時に発生するため  `(2 2) (((2 2) 4) 8)` の結果、

```
4 16 0 0 0 0
```

ということは起こりません。また、合成は進行方向先頭側が優先されます。
同じ盤面で、 R を実行すると、

```
0 0 4 4 4 8
```

という盤面になります。

もう一つ、1行 * 5列の盤面の例を考えてみます。

```
0 0 2 0 2
```

ここでRという操作を受け取った場合を考えます。
まず右方向に空きの部分を詰めるような操作が起こり、合成が発生するため、最終的に得られる盤面は次のようになります。

```
0 0 0 0 4
```

ゲームの目的は、最終的に盤面がどうなるかを求めることです。
初期盤面と操作列sが与えられるので、操作を実行後の盤面を出力するプログラムを作成してください。

## 制約

- 1 <= N <= 100
- 1 <= M <= 100
- x_ij は 2, 4, 8, 16, 32, 64 のいずれかである
- s は 100文字以下の文字列であり、各文字は U, D, L, R のいずれかである

---

## 入力

入力は以下の形式で標準入力から与えられる。
最初の行にはNとMが半角スペース区切りで与えられる。
続くN行には半角スペース区切りでM列の初期盤面が与えられる。
最後の行には操作列sが与えられる。
操作はsの先頭から順番に実行されるものとする。

```
N M
x_11 x_12 x_13 ... x_1M
x_21 x_22 x_23 ... x_2M
...
x_N1 x_N2 x_N3 ... x_NM
s
```

## 出力

N 行 M 列の最終的な盤面を出力せよ。
各数字は半角スペースで区切り、各列最後にはスペースを入れないこと。
タイルが存在しない場所は0を表記せよ。
最終行にも改行を入れること。
---

## 入力例1

```
2 3
2 2 2
2 2 2
URDL
```

## 出力例1

```
0 0 0
4 8 0
```

---

## 入力例2

```
5 7
4 64 8 32 16 2 4
2 16 2 2 4 2 2
32 2 8 8 32 16 32
32 32 32 64 8 2 8
2 8 32 16 16 64 8
ULLURUD
```

## 出力例2

```
0 0 0 0 0 0 0
0 0 0 0 0 0 0
0 0 0 0 64 16 8
0 4 64 32 32 4 32
0 64 4 128 2 128 32
```